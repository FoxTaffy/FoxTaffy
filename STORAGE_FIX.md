# üö® –°–†–û–ß–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï STORAGE

## –ü—Ä–æ–±–ª–µ–º–∞
–û—à–∏–±–∫–∞: "–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞: –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ Supabase"

## –†–µ—à–µ–Ω–∏–µ –∑–∞ 5 –º–∏–Ω—É—Ç

### –®–ê–ì 1: –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∫–µ—Ç Convent

1. –û—Ç–∫—Ä–æ–π—Ç–µ **Supabase Dashboard**: https://app.supabase.com
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç **FoxTaffy**
3. –ù–∞–∂–º–∏—Ç–µ **Storage** –≤ –ª–µ–≤–æ–º –º–µ–Ω—é
4. –ù–∞–∂–º–∏—Ç–µ **"New bucket"** (–∑–µ–ª–µ–Ω–∞—è –∫–Ω–æ–ø–∫–∞)
5. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   ```
   Name: Convent
   Public bucket: ‚úÖ –í–ö–õ (–í–ê–ñ–ù–û!)
   File size limit: 10485760
   Allowed MIME types: image/jpeg,image/png,image/gif,image/webp
   ```
6. –ù–∞–∂–º–∏—Ç–µ **"Create bucket"**

### –®–ê–ì 2: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. –í Supabase Dashboard –Ω–∞–∂–º–∏—Ç–µ **SQL Editor** (–∏–∫–æ–Ω–∫–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ —Å–ª–µ–≤–∞)
2. –ù–∞–∂–º–∏—Ç–µ **"New query"**
3. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `sql/fix_storage_quick.sql` –≤ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –í–°–Å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
5. –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor
6. –ù–∞–∂–º–∏—Ç–µ **"Run"** –∏–ª–∏ **Ctrl+Enter**
7. –î–æ–∂–¥–∏—Ç–µ—Å—å —Å–æ–æ–±—â–µ–Ω–∏—è "‚úÖ –ü–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã!"

### –®–ê–ì 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

1. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ **Storage**
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –±–∞–∫–µ—Ç **Convent**
3. –í –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É –Ω–∞–∂–º–∏—Ç–µ **"Settings"** (–∏–∫–æ–Ω–∫–∞ —à–µ—Å—Ç–µ—Ä–µ–Ω–∫–∏)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - **Public bucket**: ‚úÖ –í–ö–õ
   - **File size limit**: 10 MB
   - **Allowed MIME types**: image/jpeg, image/png, image/gif, image/webp

### –®–ê–ì 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª–∏—Ç–∏–∫–∏

1. –ù–∞–∂–º–∏—Ç–µ **Storage** ‚Üí **Policies**
2. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å 4 –ø–æ–ª–∏—Ç–∏–∫–∏:
   - ‚úÖ Allow public read
   - ‚úÖ Allow public insert
   - ‚úÖ Allow public update
   - ‚úÖ Allow public delete
3. –í—Å–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **enabled** (–≤–∫–ª—é—á–µ–Ω—ã)

### –®–ê–ì 5: –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É

1. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (F5)
2. –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
3. –°–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏

---

## ‚ùì –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ?

### –í–∞—Ä–∏–∞–Ω—Ç –ê: –°–æ–∑–¥–∞—Ç—å –±–∞–∫–µ—Ç —á–µ—Ä–µ–∑ SQL

–ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ "New bucket" –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ SQL Editor:

```sql
INSERT INTO storage.buckets (id, name, public, file_size_limit, allowed_mime_types)
VALUES (
  'Convent',
  'Convent',
  true,
  10485760,
  ARRAY['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp']
)
ON CONFLICT (id) DO UPDATE
SET public = true,
    file_size_limit = 10485760,
    allowed_mime_types = ARRAY['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp'];
```

### –í–∞—Ä–∏–∞–Ω—Ç –ë: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL –ø—Ä–æ–µ–∫—Ç–∞

–í —Ñ–∞–π–ª–µ `.env` –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
```
VITE_SUPABASE_URL=https://plugjsubjcfblzkabjia.supabase.co
VITE_SUPABASE_ANON_KEY=–≤–∞—à_–∫–ª—é—á
```

### –í–∞—Ä–∏–∞–Ω—Ç –í: –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞

1. –ù–∞–∂–º–∏—Ç–µ **Ctrl+Shift+Delete**
2. –í—ã–±–µ—Ä–∏—Ç–µ "Cached images and files"
3. –ù–∞–∂–º–∏—Ç–µ "Clear data"
4. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É (F5)

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ SQL Editor:

```sql
-- 1. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –±–∞–∫–µ—Ç?
SELECT * FROM storage.buckets WHERE name = 'Convent';

-- 2. –ü—É–±–ª–∏—á–Ω—ã–π –ª–∏ –±–∞–∫–µ—Ç?
SELECT name, public FROM storage.buckets WHERE name = 'Convent';

-- 3. –ï—Å—Ç—å –ª–∏ –ø–æ–ª–∏—Ç–∏–∫–∏?
SELECT policyname, cmd
FROM pg_policies
WHERE schemaname = 'storage'
  AND tablename = 'objects';
```

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12):

```javascript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Supabase
console.log('Supabase URL:', import.meta.env.VITE_SUPABASE_URL)

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ Storage
const { data, error } = await supabase.storage.listBuckets()
console.log('Buckets:', data)
console.log('Error:', error)
```

---

## üìû –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–∏–ª–∞—Å—å:

1. –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –æ—à–∏–±–∫–∏ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏ (F12)
2. –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç Storage ‚Üí Policies –≤ Supabase
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç SQL –∑–∞–ø—Ä–æ—Å–∞:
   ```sql
   SELECT * FROM storage.buckets WHERE name = 'Convent';
   ```
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

- [ ] –ë–∞–∫–µ—Ç **Convent** —Å–æ–∑–¥–∞–Ω
- [ ] –ë–∞–∫–µ—Ç **Convent** –ø—É–±–ª–∏—á–Ω—ã–π (Public bucket: ‚úÖ)
- [ ] SQL —Å–∫—Ä–∏–ø—Ç `fix_storage_quick.sql` –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] 4 –ø–æ–ª–∏—Ç–∏–∫–∏ —Å–æ–∑–¥–∞–Ω—ã –∏ –≤–∫–ª—é—á–µ–Ω—ã
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (F5)
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

**–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö —à–∞–≥–æ–≤ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ–ª–∂–Ω–∞ –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å!** üéâ
