# üì¶ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase Storage –¥–ª—è FoxTaffy

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–º–æ–∂–µ—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Supabase Storage –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –º–∏–Ω–∏–∞—Ç—é—Ä.

## üéØ –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏–Ω–∏–∞—Ç—é—Ä
- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–∞–∂–¥–æ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –º–∏–Ω–∏–∞—Ç—é—Ä–∞ (–º–∞–∫—Å–∏–º—É–º 400x400px)
- –û—Ä–∏–≥–∏–Ω–∞–ª—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `original/`
- –ú–∏–Ω–∏–∞—Ç—é—Ä—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `thumbnails/`
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∞–π—Ç–∞

### ‚úÖ –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è
```
Convent (bucket)
‚îî‚îÄ‚îÄ events/
    ‚îî‚îÄ‚îÄ {event-id}/
        ‚îú‚îÄ‚îÄ original/         - –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ (–ø–æ–ª–Ω—ã–π —Ä–∞–∑–º–µ—Ä)
        ‚îú‚îÄ‚îÄ thumbnails/       - –ú–∏–Ω–∏–∞—Ç—é—Ä—ã 400x400px –¥–ª—è –ø—Ä–µ–≤—å—é
        ‚îú‚îÄ‚îÄ avatar/           - –ê–≤–∞—Ç–∞—Ä/–ª–æ–≥–æ—Ç–∏–ø –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
        ‚îî‚îÄ‚îÄ banner/           - –ë–∞–Ω–Ω–µ—Ä –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
```

### ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∂–∞—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –∫–∞—á–µ—Å—Ç–≤–∞
- Lazy loading –º–∏–Ω–∏–∞—Ç—é—Ä –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö
- –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∫–ª–∏–∫–µ
- –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

### –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª–∏—Ç–∏–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ Supabase

1. –û—Ç–∫—Ä–æ–π—Ç–µ **Supabase Dashboard** ‚Üí https://app.supabase.com
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç **FoxTaffy**
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **SQL Editor** (–∏–∫–æ–Ω–∫–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ —Å–ª–µ–≤–∞)
4. –ù–∞–∂–º–∏—Ç–µ **New query**
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ **`sql/setup_storage_policies.sql`**
6. –í—Å—Ç–∞–≤—å—Ç–µ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä SQL
7. –ù–∞–∂–º–∏—Ç–µ **Run** (–∏–ª–∏ Ctrl+Enter)
8. –î–æ–∂–¥–∏—Ç–µ—Å—å —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

#### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç SQL —Å–∫—Ä–∏–ø—Ç:
- ‚úÖ –°–æ–∑–¥–∞–µ—Ç –±–∞–∫–µ—Ç—ã `Convent` –∏ `gallery` (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç)
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –¥–ª—è —á—Ç–µ–Ω–∏—è
- ‚úÖ –†–∞–∑—Ä–µ—à–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ä–∞–∑–º–µ—Ä—É (10MB) –∏ —Ç–∏–ø—É —Ñ–∞–π–ª–æ–≤

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Storage** –≤ Supabase Dashboard
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏–¥–∏—Ç–µ –±–∞–∫–µ—Ç—ã:
   - **Convent** (–¥–ª—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π)
   - **gallery** (–¥–ª—è –æ–±—â–∏—Ö —Ñ–∞–π–ª–æ–≤)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–∂–¥–æ–≥–æ –±–∞–∫–µ—Ç–∞:
   - Public: ‚úÖ Enabled
   - File size limit: 10 MB
   - Allowed MIME types: image/jpeg, image/png, image/gif, image/webp

### –®–∞–≥ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `npm run dev`
2. –í–æ–π–¥–∏—Ç–µ –≤ **–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å**
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ (–∏–ª–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ)
4. –ù–∞ —à–∞–≥–µ "–û—Ç–∑—ã–≤ –∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏" –Ω–∞–∂–º–∏—Ç–µ **"–í—ã–±—Ä–∞—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏"**
5. –í—ã–±–µ—Ä–∏—Ç–µ 2-3 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
6. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏

#### –ß—Ç–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏:
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ –ö–∞–∂–¥–æ–µ —Ñ–æ—Ç–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è: –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è ‚Üí –º–∏–Ω–∏–∞—Ç—é—Ä–∞ ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞
- ‚úÖ –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–Ω—ã –ø—Ä–µ–≤—å—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- ‚úÖ –í Storage –ø–æ—è–≤–ª—è—é—Ç—Å—è –ø–∞–ø–∫–∏:
  - `events/{event-id}/original/` - –æ—Ä–∏–≥–∏–Ω–∞–ª—ã
  - `events/{event-id}/thumbnails/` - –º–∏–Ω–∏–∞—Ç—é—Ä—ã

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞

#### `/src/config/s3.js`
**–û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ Storage:**
- `uploadFile()` - –±–∞–∑–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
- `uploadImageWithThumbnail()` - –∑–∞–≥—Ä—É–∑–∫–∞ —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º –º–∏–Ω–∏–∞—Ç—é—Ä—ã
- `uploadEventPhotos()` - –º–∞—Å—Å–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
- `deleteEventFiles()` - —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è

**–£—Ç–∏–ª–∏—Ç—ã:**
- `createThumbnailBlob()` - —Å–æ–∑–¥–∞–Ω–∏–µ –º–∏–Ω–∏–∞—Ç—é—Ä—ã —á–µ—Ä–µ–∑ Canvas API
- `optimizeImage()` - —Å–∂–∞—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `getEventFolderPath()` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—É—Ç–∏ –∫ –ø–∞–ø–∫–µ

#### `/src/config/supabase.js`
**–ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö:**
- `saveEventPhotos()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –≤ –ë–î
- `deleteEventPhotos()` - —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –∏–∑ –ë–î
- `_cleanEventData()` - –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Å `photos_count`)

#### `/src/components/AdminEventsPanel.vue`
**–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º–∏:**
- `handleMultiPhotoUpload()` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ñ–æ—Ç–æ
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π –º–∏–Ω–∏–∞—Ç—é—Ä
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è ID –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∏–Ω–∏–∞—Ç—é—Ä

```javascript
const THUMBNAIL_MAX_WIDTH = 400    // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞
const THUMBNAIL_MAX_HEIGHT = 400   // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞
const THUMBNAIL_QUALITY = 0.8      // –ö–∞—á–µ—Å—Ç–≤–æ JPEG (0-1)
```

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- ‚úÖ JPEG / JPG
- ‚úÖ PNG
- ‚úÖ GIF
- ‚úÖ WebP

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: **10 MB**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –∑–∞ —Ä–∞–∑: **–Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ** (–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ 20)

## üêõ Troubleshooting (–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º)

### –û—à–∏–±–∫–∞: "Could not find the 'photos_count' column"

**–†–µ—à–µ–Ω–∏–µ:** –≠—Ç–∞ –æ—à–∏–±–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ –∫–æ–¥–µ. –ü–æ–ª–µ `photos_count` - –≤—ã—á–∏—Å–ª—è–µ–º–æ–µ –∏ –±–æ–ª—å—à–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏.

### –û—à–∏–±–∫–∞: "–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞: –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"

**–ü—Ä–∏—á–∏–Ω–∞:** Storage –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã.

**–†–µ—à–µ–Ω–∏–µ:**
1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç `sql/setup_storage_policies.sql`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–∞–∫–µ—Ç—ã `Convent` –∏ `gallery` —Å—É—â–µ—Å—Ç–≤—É—é—Ç
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∫–µ—Ç—ã –∏–º–µ—é—Ç —Å—Ç–∞—Ç—É—Å **Public**

### –û—à–∏–±–∫–∞: "Bucket not found"

**–†–µ—à–µ–Ω–∏–µ:**
1. –í Supabase Dashboard ‚Üí Storage
2. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∫–µ—Ç –≤—Ä—É—á–Ω—É—é:
   - Name: `Convent`
   - Public: ‚úÖ ON
   - File size limit: `10485760` (10MB)
   - Allowed MIME types: `image/jpeg, image/png, image/gif, image/webp`

### –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. **–ë–∞–∫–µ—Ç –Ω–µ –ø—É–±–ª–∏—á–Ω—ã–π** ‚Üí –í–∫–ª—é—á–∏—Ç–µ Public –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±–∞–∫–µ—Ç–∞
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL** ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –≤ —Ç–∞–±–ª–∏—Ü–µ `con_photos`
3. **–ü–æ–ª–∏—Ç–∏–∫–∏ RLS** ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ SQL —Å–∫—Ä–∏–ø—Ç

### –ú–∏–Ω–∏–∞—Ç—é—Ä—ã –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. Console –≤ –±—Ä–∞—É–∑–µ—Ä–µ (F12) - —Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±—Ä–∞—É–∑–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Canvas API
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤ (–Ω–µ –±–æ–ª–µ–µ 10MB)

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `con_photos`

```sql
CREATE TABLE con_photos (
  id BIGSERIAL PRIMARY KEY,
  con_id BIGINT REFERENCES cons(id) ON DELETE CASCADE,
  image_url TEXT NOT NULL,              -- URL –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
  thumbnail_url TEXT,                   -- URL –º–∏–Ω–∏–∞—Ç—é—Ä—ã
  file_path TEXT,                       -- –ü—É—Ç—å –≤ Storage (–æ—Ä–∏–≥–∏–Ω–∞–ª)
  thumbnail_path TEXT,                  -- –ü—É—Ç—å –≤ Storage (–º–∏–Ω–∏–∞—Ç—é—Ä–∞)
  file_size INTEGER,                    -- –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –±–∞–π—Ç–∞—Ö
  file_name TEXT,                       -- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞
  caption TEXT,                         -- –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
  is_featured BOOLEAN DEFAULT false,    -- –ò–∑–±—Ä–∞–Ω–Ω–∞—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è
  display_order INTEGER DEFAULT 0,      -- –ü–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  created_at TIMESTAMP DEFAULT NOW()
);
```

## üé® –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### –ü—Ä–∏–º–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –æ–¥–Ω–æ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Å –º–∏–Ω–∏–∞—Ç—é—Ä–æ–π

```javascript
import { s3Api } from '@/config/s3.js'

const file = /* File object from input */
const eventId = 123

const result = await s3Api.uploadImageWithThumbnail(
  file,
  `events/${eventId}`,
  (progress) => {
    console.log(`–ó–∞–≥—Ä—É–∑–∫–∞: ${progress}%`)
  }
)

console.log('–û—Ä–∏–≥–∏–Ω–∞–ª:', result.original.url)
console.log('–ú–∏–Ω–∏–∞—Ç—é—Ä–∞:', result.thumbnail.url)
```

### –ü—Ä–∏–º–µ—Ä –º–∞—Å—Å–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

```javascript
import { s3Api } from '@/config/s3.js'
import { furryApi } from '@/config/supabase.js'

const files = /* Array of File objects */
const eventId = 123

// –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
const results = await s3Api.uploadEventPhotos(
  files,
  eventId,
  (totalProgress, currentFile, totalFiles) => {
    console.log(`–§–æ—Ç–æ ${currentFile}/${totalFiles} - ${totalProgress}%`)
  }
)

// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ë–î
await furryApi.saveEventPhotos(eventId, results)
```

## üìù Changelog

### v2.0 - –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏–Ω–∏–∞—Ç—é—Ä —á–µ—Ä–µ–∑ Canvas API
- ‚úÖ –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ –ø–æ ID –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Å `photos_count` –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ Storage (RLS policies)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∞—Å—Å–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ –ë–î

### v1.0 - –ü—Ä–µ–¥—ã–¥—É—â–∞—è –≤–µ—Ä—Å–∏—è
- –ü—Ä–æ—Å—Ç–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –±–µ–∑ –º–∏–Ω–∏–∞—Ç—é—Ä
- –ù–µ–æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è
- –†—É—á–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –ø—É—Ç–µ–π –∫ —Ñ–∞–π–ª–∞–º

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Supabase Storage Documentation](https://supabase.com/docs/guides/storage)
- [Canvas API –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π](https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API)
- [Supabase Row Level Security](https://supabase.com/docs/guides/auth/row-level-security)

## üí° –°–æ–≤–µ—Ç—ã –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ WebP** –¥–ª—è –µ—â–µ –ª—É—á—à–µ–≥–æ —Å–∂–∞—Ç–∏—è (–µ—Å–ª–∏ –±—Ä–∞—É–∑–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç)
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ CDN** –≤ Supabase –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä–∞–∑–¥–∞—á–∏ —Ñ–∞–π–ª–æ–≤
3. **–í–∫–ª—é—á–∏—Ç–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –Ω–∞ —É—Ä–æ–≤–Ω–µ –±—Ä–∞—É–∑–µ—Ä–∞
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ lazy loading** –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤–Ω–µ –≤–∏–¥–∏–º–æ–π –æ–±–ª–∞—Å—Ç–∏
5. **–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ Progressive JPEG** –¥–ª—è –±–æ–ª—å—à–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

---

**–ì–æ—Ç–æ–≤–æ!** üéâ –¢–µ–ø–µ—Ä—å –≤–∞—à —Å–∞–π—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏!

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã, —Å–æ–∑–¥–∞–π—Ç–µ issue –≤ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
